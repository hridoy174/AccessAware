chrome.runtime.onMessage.addListener((function(e,s,t){if("logAccess"===e.action)return chrome.storage.local.get({logs:[],notificationsEnabled:!0},(function(o){var c=o.logs,n=new URL(s.tab.url).hostname,r=c[c.length-1];r&&r.url===n&&r.resource===e.resource&&new Date-new Date(r.timestamp)<6e4?t({status:"ignored-duplicate"}):(c.push({url:n,resource:e.resource,timestamp:(new Date).toISOString()}),chrome.storage.local.set({logs:c},(function(){console.log("âœ… Log saved successfully:",c)})),o.notificationsEnabled&&chrome.notifications.create({type:"basic",iconUrl:"assets/icons/128.png",title:"AccessAware Alert",message:"".concat(n," is accessing your ").concat(e.resource,"!"),priority:2}),t({status:"received"}))})),!0}));